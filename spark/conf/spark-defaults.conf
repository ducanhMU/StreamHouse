# ==========================================
# APPLICATION & DEPLOYMENT
# ==========================================
spark.app.name                      JADC2-Pipeline
spark.submit.deployMode             client
spark.master                        local[*]
# (Hoặc spark://spark-master:7077 nếu chạy cluster mode)

# ==========================================
# DELTA LAKE & CATALOG
# ==========================================
spark.sql.extensions                io.delta.sql.DeltaSparkSessionExtension
spark.sql.catalog.spark_catalog     org.apache.spark.sql.delta.catalog.DeltaCatalog
spark.databricks.delta.schema.autoMerge.enabled         true

# ==========================================
# HIVE METASTORE INTEGRATION
# ==========================================
spark.sql.catalogImplementation                 hive
# SỬA: Hostname phải là 'hms'
spark.hadoop.hive.metastore.uris                thrift://hms:9083
spark.sql.hive.metastore.version                3.1.3
spark.sql.hive.metastore.jars                   maven

# ==========================================
# HDFS CONFIGURATION
# ==========================================
spark.hadoop.fs.defaultFS                       hdfs://namenode:9000
spark.hadoop.dfs.client.use.datanode.hostname   true

# ==========================================
# CLASSPATH (QUAN TRỌNG)
# ==========================================
# SỬA: Load jar cụ thể hoặc qua extraClassPath, tránh dùng wildcard ở spark.jars
spark.driver.extraClassPath     /opt/spark/jars_extra/*
spark.executor.extraClassPath   /opt/spark/jars_extra/*

# ==========================================
# OPENMETADATA LINEAGE (Optional)
# ==========================================
spark.extraListeners            org.openmetadata.spark.agent.OpenMetadataSparkListener
spark.openmetadata.transport.hostPort   http://om-server:8585
spark.openmetadata.pipelineServiceName  jadc2_spark_pipeline
